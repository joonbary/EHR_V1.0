# Generated by Django 5.2.4 on 2025-08-18 05:13

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('employees', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='RiskFactor',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, unique=True, verbose_name='요소명')),
                ('factor_type', models.CharField(choices=[('PERFORMANCE', '성과'), ('ENGAGEMENT', '몰입도'), ('COMPENSATION', '보상'), ('WORKLOAD', '업무량'), ('RELATIONSHIP', '관계'), ('CAREER', '경력 개발'), ('WORK_ENVIRONMENT', '근무 환경'), ('EXTERNAL', '외부 요인')], max_length=20, verbose_name='요소 유형')),
                ('description', models.TextField(verbose_name='설명')),
                ('base_weight', models.FloatField(default=1.0, verbose_name='기본 가중치')),
                ('adjustment_rules', models.JSONField(default=dict, verbose_name='조정 규칙')),
                ('is_active', models.BooleanField(default=True, verbose_name='활성화')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='생성일시')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='수정일시')),
            ],
            options={
                'verbose_name': '위험 요소',
                'verbose_name_plural': '위험 요소',
                'ordering': ['factor_type', 'name'],
            },
        ),
        migrations.CreateModel(
            name='TurnoverRisk',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('risk_level', models.CharField(choices=[('LOW', '낮음'), ('MEDIUM', '보통'), ('HIGH', '높음'), ('CRITICAL', '매우 높음')], max_length=10, verbose_name='위험 수준')),
                ('risk_score', models.FloatField(help_text='0.0-1.0 사이 위험도 점수', verbose_name='위험도 점수')),
                ('prediction_date', models.DateTimeField(auto_now_add=True, verbose_name='예측 일시')),
                ('predicted_departure_date', models.DateField(blank=True, null=True, verbose_name='예상 퇴사일')),
                ('confidence_level', models.FloatField(default=0.0, verbose_name='AI 신뢰도')),
                ('primary_risk_factors', models.JSONField(default=list, verbose_name='주요 위험 요소')),
                ('secondary_risk_factors', models.JSONField(default=list, verbose_name='부차 위험 요소')),
                ('protective_factors', models.JSONField(default=list, verbose_name='보호 요소')),
                ('ai_analysis', models.JSONField(default=dict, verbose_name='AI 분석 결과')),
                ('ai_recommendations', models.JSONField(default=list, verbose_name='AI 추천 사항')),
                ('ai_model_version', models.CharField(default='v1.0', max_length=50, verbose_name='AI 모델 버전')),
                ('status', models.CharField(choices=[('ACTIVE', '활성'), ('MONITORING', '모니터링 중'), ('RESOLVED', '해결됨'), ('ARCHIVED', '보관됨')], default='ACTIVE', max_length=20, verbose_name='상태')),
                ('last_updated', models.DateTimeField(auto_now=True, verbose_name='마지막 업데이트')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='생성자')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='turnover_risks', to='employees.employee', verbose_name='직원')),
            ],
            options={
                'verbose_name': '이직 위험도',
                'verbose_name_plural': '이직 위험도',
                'ordering': ['-risk_score', '-prediction_date'],
                'unique_together': {('employee', 'prediction_date')},
            },
        ),
        migrations.CreateModel(
            name='TurnoverAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('alert_type', models.CharField(choices=[('RISK_INCREASE', '위험도 증가'), ('CRITICAL_LEVEL', '임계 수준 도달'), ('PATTERN_DETECTED', '패턴 감지'), ('PLAN_OVERDUE', '계획 지연'), ('SUCCESS_UPDATE', '성공 업데이트')], max_length=20, verbose_name='알림 유형')),
                ('severity', models.CharField(choices=[('INFO', '정보'), ('WARNING', '경고'), ('CRITICAL', '중요'), ('EMERGENCY', '긴급')], max_length=10, verbose_name='심각도')),
                ('title', models.CharField(max_length=200, verbose_name='제목')),
                ('message', models.TextField(verbose_name='메시지')),
                ('details', models.JSONField(default=dict, verbose_name='상세 정보')),
                ('is_read', models.BooleanField(default=False, verbose_name='읽음')),
                ('is_acknowledged', models.BooleanField(default=False, verbose_name='확인')),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True, verbose_name='확인 시간')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='생성일시')),
                ('expires_at', models.DateTimeField(blank=True, null=True, verbose_name='만료 시간')),
                ('acknowledged_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='acknowledged_alerts', to=settings.AUTH_USER_MODEL, verbose_name='확인자')),
                ('recipients', models.ManyToManyField(related_name='turnover_alerts', to=settings.AUTH_USER_MODEL, verbose_name='수신자')),
                ('turnover_risk', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alerts', to='ai_predictions.turnoverrisk', verbose_name='이직 위험도')),
            ],
            options={
                'verbose_name': '이직 위험도 알림',
                'verbose_name_plural': '이직 위험도 알림',
                'ordering': ['-severity', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RetentionPlan',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200, verbose_name='계획명')),
                ('description', models.TextField(verbose_name='계획 설명')),
                ('priority', models.CharField(choices=[('LOW', '낮음'), ('MEDIUM', '보통'), ('HIGH', '높음'), ('URGENT', '긴급')], default='MEDIUM', max_length=10, verbose_name='우선순위')),
                ('status', models.CharField(choices=[('DRAFT', '초안'), ('ACTIVE', '실행 중'), ('COMPLETED', '완료'), ('CANCELLED', '취소'), ('ON_HOLD', '보류')], default='DRAFT', max_length=20, verbose_name='상태')),
                ('action_items', models.JSONField(default=list, verbose_name='실행 항목')),
                ('success_metrics', models.JSONField(default=list, verbose_name='성공 지표')),
                ('start_date', models.DateField(verbose_name='시작일')),
                ('target_completion_date', models.DateField(verbose_name='목표 완료일')),
                ('actual_completion_date', models.DateField(blank=True, null=True, verbose_name='실제 완료일')),
                ('estimated_budget', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='예상 예산')),
                ('actual_cost', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='실제 비용')),
                ('required_resources', models.JSONField(default=list, verbose_name='필요 리소스')),
                ('effectiveness_score', models.FloatField(blank=True, null=True, verbose_name='효과성 점수')),
                ('employee_feedback', models.TextField(blank=True, verbose_name='직원 피드백')),
                ('manager_notes', models.TextField(blank=True, verbose_name='관리자 노트')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='생성일시')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='수정일시')),
                ('assigned_hr', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='retention_plans_as_hr', to=settings.AUTH_USER_MODEL, verbose_name='담당 HR')),
                ('assigned_manager', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='retention_plans_as_manager', to=settings.AUTH_USER_MODEL, verbose_name='담당 관리자')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='생성자')),
                ('turnover_risk', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='retention_plan', to='ai_predictions.turnoverrisk', verbose_name='이직 위험도')),
            ],
            options={
                'verbose_name': '유지 계획',
                'verbose_name_plural': '유지 계획',
                'ordering': ['-priority', '-created_at'],
            },
        ),
    ]
