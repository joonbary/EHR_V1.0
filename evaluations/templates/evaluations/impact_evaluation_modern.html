{% extends 'base.html' %}
{% load static %}

{% block title %}ì˜í–¥ë ¥ í‰ê°€ - {{ employee.name }}{% endblock %}

{% block extra_css %}
<style>
    .evaluation-card {
        background: linear-gradient(135deg, white 0%, #FFF4ED 100%);
        border: 1px solid rgba(255, 107, 0, 0.1);
    }
    
    .impact-option {
        transition: all 0.3s ease;
        cursor: pointer;
        border: 2px solid transparent;
    }
    
    .impact-option:hover {
        border-color: rgba(255, 107, 0, 0.3);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 107, 0, 0.15);
    }
    
    .impact-option.selected {
        border-color: #FF6B00;
        background: linear-gradient(135deg, white 0%, #FFF4ED 100%);
    }
    
    .values-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
    }
    
    .value-card {
        position: relative;
        transition: all 0.3s ease;
    }
    
    .value-card:hover {
        transform: scale(1.02);
    }
    
    input[type="radio"]:checked + .value-label {
        background: #FF6B00;
        color: white;
        border-color: #FF6B00;
    }
    
    .value-label {
        display: block;
        padding: 1rem;
        border: 2px solid #E5E7EB;
        border-radius: 0.5rem;
        cursor: pointer;
        transition: all 0.2s ease;
    }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-white to-brand-gray/10 py-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="mb-8">
            <nav class="flex mb-4" aria-label="Breadcrumb">
                <ol class="inline-flex items-center space-x-1 md:space-x-3">
                    <li><a href="{% url 'evaluations:dashboard' %}" class="text-gray-500 hover:text-primary transition-colors">í‰ê°€ê´€ë¦¬</a></li>
                    <li><span class="mx-2 text-gray-400">/</span></li>
                    <li><a href="{% url 'evaluations:impact_employees' %}" class="text-gray-500 hover:text-primary transition-colors">ì˜í–¥ë ¥ í‰ê°€</a></li>
                    <li><span class="mx-2 text-gray-400">/</span></li>
                    <li class="text-gray-900 font-medium">{{ employee.name }}</li>
                </ol>
            </nav>
            
            <div class="bg-white rounded-2xl shadow-sm p-6 evaluation-card">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-900 mb-2">
                            <i class="fas fa-users text-primary mr-3"></i>ì˜í–¥ë ¥ í‰ê°€
                        </h1>
                        <div class="flex items-center gap-4 text-gray-600">
                            <span class="flex items-center">
                                <i class="fas fa-user mr-2"></i>
                                <strong>{{ employee.name }}</strong> ({{ employee.employee_id }})
                            </span>
                            <span class="flex items-center">
                                <i class="fas fa-building mr-2"></i>
                                {{ employee.department.name }}
                            </span>
                            <span class="flex items-center">
                                <i class="fas fa-calendar mr-2"></i>
                                {{ active_period }}
                            </span>
                        </div>
                    </div>
                    <div class="text-right">
                        {% if evaluation.total_score %}
                        <div class="text-sm text-gray-500 mb-1">í˜„ì¬ ì ìˆ˜</div>
                        <div class="text-3xl font-bold text-primary">{{ evaluation.total_score|floatformat:1 }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <form method="post" class="space-y-6">
            {% csrf_token %}
            
            <!-- ì˜í–¥ë ¥ ë²”ìœ„ í‰ê°€ -->
            <div class="bg-white rounded-xl shadow-sm p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-6">
                    <i class="fas fa-chart-network text-primary mr-2"></i>ì˜í–¥ë ¥ ë²”ìœ„
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="impact-option p-6 rounded-lg bg-gray-50 text-center {% if evaluation.impact_scope == 'org' %}selected{% endif %}">
                        <input type="radio" id="scope_org" name="impact_scope" value="org" 
                               {% if evaluation.impact_scope == 'org' %}checked{% endif %}
                               class="sr-only">
                        <label for="scope_org" class="cursor-pointer">
                            <div class="text-4xl mb-3">ğŸ¢</div>
                            <div class="font-semibold text-lg mb-2">ì¡°ì§ ì „ì²´</div>
                            <div class="text-sm text-gray-600">ì¡°ì§ ì „ì²´ì— ê¸ì •ì  ì˜í–¥</div>
                            <div class="mt-3 text-2xl font-bold text-primary">4ì </div>
                        </label>
                    </div>
                    
                    <div class="impact-option p-6 rounded-lg bg-gray-50 text-center {% if evaluation.impact_scope == 'department' %}selected{% endif %}">
                        <input type="radio" id="scope_department" name="impact_scope" value="department" 
                               {% if evaluation.impact_scope == 'department' %}checked{% endif %}
                               class="sr-only">
                        <label for="scope_department" class="cursor-pointer">
                            <div class="text-4xl mb-3">ğŸ—ï¸</div>
                            <div class="font-semibold text-lg mb-2">ë¶€ì„œ ë‚´</div>
                            <div class="text-sm text-gray-600">ì†Œì† ë¶€ì„œ ë‚´ ì˜í–¥ë ¥</div>
                            <div class="mt-3 text-2xl font-bold text-accent">3ì </div>
                        </label>
                    </div>
                    
                    <div class="impact-option p-6 rounded-lg bg-gray-50 text-center {% if evaluation.impact_scope == 'team' %}selected{% endif %}">
                        <input type="radio" id="scope_team" name="impact_scope" value="team" 
                               {% if evaluation.impact_scope == 'team' %}checked{% endif %}
                               class="sr-only">
                        <label for="scope_team" class="cursor-pointer">
                            <div class="text-4xl mb-3">ğŸ‘¥</div>
                            <div class="font-semibold text-lg mb-2">íŒ€ ë‚´</div>
                            <div class="text-sm text-gray-600">íŒ€ ë‚´ ì œí•œì  ì˜í–¥</div>
                            <div class="mt-3 text-2xl font-bold text-gray-600">2ì </div>
                        </label>
                    </div>
                </div>
            </div>

            <!-- í•µì‹¬ê°€ì¹˜ ì‹¤ì²œ -->
            <div class="bg-white rounded-xl shadow-sm p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-6">
                    <i class="fas fa-heart text-primary mr-2"></i>í•µì‹¬ê°€ì¹˜ ì‹¤ì²œ
                </h2>
                
                <div class="values-grid">
                    <div class="value-card">
                        <input type="radio" id="values_all" name="core_values_practice" value="all_values" 
                               {% if evaluation.core_values_practice == 'all_values' %}checked{% endif %}
                               class="sr-only">
                        <label for="values_all" class="value-label">
                            <div class="flex items-center mb-2">
                                <span class="text-2xl mr-3">ğŸŒŸ</span>
                                <span class="font-semibold">ëª¨ë“  í•µì‹¬ê°€ì¹˜ ì‹¤ì²œ</span>
                            </div>
                            <p class="text-sm text-gray-600">í˜ì‹ , í˜‘ë ¥, ì‹ ë¢°, ë„ì „ ë“± ëª¨ë“  ê°€ì¹˜ ì²´í™”</p>
                            <div class="mt-2 text-lg font-bold text-primary">4ì </div>
                        </label>
                    </div>
                    
                    <div class="value-card">
                        <input type="radio" id="values_most" name="core_values_practice" value="most_values" 
                               {% if evaluation.core_values_practice == 'most_values' %}checked{% endif %}
                               class="sr-only">
                        <label for="values_most" class="value-label">
                            <div class="flex items-center mb-2">
                                <span class="text-2xl mr-3">â­</span>
                                <span class="font-semibold">ëŒ€ë¶€ë¶„ í•µì‹¬ê°€ì¹˜ ì‹¤ì²œ</span>
                            </div>
                            <p class="text-sm text-gray-600">3ê°œ ì´ìƒì˜ í•µì‹¬ê°€ì¹˜ ì‹¤ì²œ</p>
                            <div class="mt-2 text-lg font-bold text-accent">3ì </div>
                        </label>
                    </div>
                    
                    <div class="value-card">
                        <input type="radio" id="values_some" name="core_values_practice" value="some_values" 
                               {% if evaluation.core_values_practice == 'some_values' %}checked{% endif %}
                               class="sr-only">
                        <label for="values_some" class="value-label">
                            <div class="flex items-center mb-2">
                                <span class="text-2xl mr-3">âœ¨</span>
                                <span class="font-semibold">ì¼ë¶€ í•µì‹¬ê°€ì¹˜ ì‹¤ì²œ</span>
                            </div>
                            <p class="text-sm text-gray-600">1-2ê°œ í•µì‹¬ê°€ì¹˜ ì‹¤ì²œ</p>
                            <div class="mt-2 text-lg font-bold text-blue-600">2ì </div>
                        </label>
                    </div>
                    
                    <div class="value-card">
                        <input type="radio" id="values_limited" name="core_values_practice" value="limited_values" 
                               {% if evaluation.core_values_practice == 'limited_values' %}checked{% endif %}
                               class="sr-only">
                        <label for="values_limited" class="value-label">
                            <div class="flex items-center mb-2">
                                <span class="text-2xl mr-3">ğŸ’«</span>
                                <span class="font-semibold">ì œí•œì  ì‹¤ì²œ</span>
                            </div>
                            <p class="text-sm text-gray-600">í•µì‹¬ê°€ì¹˜ ì‹¤ì²œ ë¯¸í¡</p>
                            <div class="mt-2 text-lg font-bold text-gray-600">1ì </div>
                        </label>
                    </div>
                </div>
            </div>

            <!-- ë¦¬ë”ì‹­ ë°œíœ˜ -->
            <div class="bg-white rounded-xl shadow-sm p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-6">
                    <i class="fas fa-medal text-primary mr-2"></i>ë¦¬ë”ì‹­ ë°œíœ˜
                </h2>
                
                <div class="values-grid">
                    <div class="value-card">
                        <input type="radio" id="leader_exceptional" name="leadership_demonstration" value="exceptional_leadership" 
                               {% if evaluation.leadership_demonstration == 'exceptional_leadership' %}checked{% endif %}
                               class="sr-only">
                        <label for="leader_exceptional" class="value-label">
                            <div class="flex items-center mb-2">
                                <span class="text-2xl mr-3">ğŸ‘‘</span>
                                <span class="font-semibold">íƒì›”í•œ ë¦¬ë”ì‹­</span>
                            </div>
                            <p class="text-sm text-gray-600">ì¡°ì§ ì „ì²´ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ë¦¬ë”ì‹­ ë°œíœ˜</p>
                            <div class="mt-2 text-lg font-bold text-primary">4ì </div>
                        </label>
                    </div>
                    
                    <div class="value-card">
                        <input type="radio" id="leader_strong" name="leadership_demonstration" value="strong_leadership" 
                               {% if evaluation.leadership_demonstration == 'strong_leadership' %}checked{% endif %}
                               class="sr-only">
                        <label for="leader_strong" class="value-label">
                            <div class="flex items-center mb-2">
                                <span class="text-2xl mr-3">ğŸ¯</span>
                                <span class="font-semibold">ê°•í•œ ë¦¬ë”ì‹­</span>
                            </div>
                            <p class="text-sm text-gray-600">ë¶€ì„œ/íŒ€ì„ ì´ë„ëŠ” ë¦¬ë”ì‹­ ë°œíœ˜</p>
                            <div class="mt-2 text-lg font-bold text-accent">3ì </div>
                        </label>
                    </div>
                    
                    <div class="value-card">
                        <input type="radio" id="leader_moderate" name="leadership_demonstration" value="moderate_leadership" 
                               {% if evaluation.leadership_demonstration == 'moderate_leadership' %}checked{% endif %}
                               class="sr-only">
                        <label for="leader_moderate" class="value-label">
                            <div class="flex items-center mb-2">
                                <span class="text-2xl mr-3">ğŸŒ±</span>
                                <span class="font-semibold">ë³´í†µ ë¦¬ë”ì‹­</span>
                            </div>
                            <p class="text-sm text-gray-600">íŒ€ ë‚´ì—ì„œ ì¼ë¶€ ë¦¬ë”ì‹­ ë°œíœ˜</p>
                            <div class="mt-2 text-lg font-bold text-blue-600">2ì </div>
                        </label>
                    </div>
                    
                    <div class="value-card">
                        <input type="radio" id="leader_limited" name="leadership_demonstration" value="limited_leadership" 
                               {% if evaluation.leadership_demonstration == 'limited_leadership' %}checked{% endif %}
                               class="sr-only">
                        <label for="leader_limited" class="value-label">
                            <div class="flex items-center mb-2">
                                <span class="text-2xl mr-3">ğŸŒ¿</span>
                                <span class="font-semibold">ì œí•œì  ë¦¬ë”ì‹­</span>
                            </div>
                            <p class="text-sm text-gray-600">ë¦¬ë”ì‹­ ë°œíœ˜ ê¸°íšŒ ì œí•œì </p>
                            <div class="mt-2 text-lg font-bold text-gray-600">1ì </div>
                        </label>
                    </div>
                </div>
            </div>

            <!-- ê¸°ì¡´ í‰ê°€ í•­ëª© (ë ˆê±°ì‹œ í˜¸í™˜) -->
            <div class="bg-white rounded-xl shadow-sm p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-6">
                    <i class="fas fa-star text-primary mr-2"></i>ì„¸ë¶€ í‰ê°€ í•­ëª©
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê³ ê° ì¤‘ì‹¬</label>
                        <select name="customer_focus" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary">
                            <option value="1" {% if evaluation.customer_focus == 1 %}selected{% endif %}>1 - ê¸°ëŒ€ ë¯¸ë‹¬</option>
                            <option value="2" {% if evaluation.customer_focus == 2 %}selected{% endif %}>2 - ê¸°ëŒ€ ì¶©ì¡±</option>
                            <option value="3" {% if evaluation.customer_focus == 3 %}selected{% endif %}>3 - ê¸°ëŒ€ ì´ˆê³¼</option>
                            <option value="4" {% if evaluation.customer_focus == 4 %}selected{% endif %}>4 - íƒì›”</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">í˜‘ì—…</label>
                        <select name="collaboration" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary">
                            <option value="1" {% if evaluation.collaboration == 1 %}selected{% endif %}>1 - ê¸°ëŒ€ ë¯¸ë‹¬</option>
                            <option value="2" {% if evaluation.collaboration == 2 %}selected{% endif %}>2 - ê¸°ëŒ€ ì¶©ì¡±</option>
                            <option value="3" {% if evaluation.collaboration == 3 %}selected{% endif %}>3 - ê¸°ëŒ€ ì´ˆê³¼</option>
                            <option value="4" {% if evaluation.collaboration == 4 %}selected{% endif %}>4 - íƒì›”</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">í˜ì‹ </label>
                        <select name="innovation" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary">
                            <option value="1" {% if evaluation.innovation == 1 %}selected{% endif %}>1 - ê¸°ëŒ€ ë¯¸ë‹¬</option>
                            <option value="2" {% if evaluation.innovation == 2 %}selected{% endif %}>2 - ê¸°ëŒ€ ì¶©ì¡±</option>
                            <option value="3" {% if evaluation.innovation == 3 %}selected{% endif %}>3 - ê¸°ëŒ€ ì´ˆê³¼</option>
                            <option value="4" {% if evaluation.innovation == 4 %}selected{% endif %}>4 - íƒì›”</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">íŒ€ ë¦¬ë”ì‹­</label>
                        <select name="team_leadership" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary">
                            <option value="1" {% if evaluation.team_leadership == 1 %}selected{% endif %}>1 - ê¸°ëŒ€ ë¯¸ë‹¬</option>
                            <option value="2" {% if evaluation.team_leadership == 2 %}selected{% endif %}>2 - ê¸°ëŒ€ ì¶©ì¡±</option>
                            <option value="3" {% if evaluation.team_leadership == 3 %}selected{% endif %}>3 - ê¸°ëŒ€ ì´ˆê³¼</option>
                            <option value="4" {% if evaluation.team_leadership == 4 %}selected{% endif %}>4 - íƒì›”</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ì¡°ì§ ì˜í–¥ë ¥</label>
                        <select name="organizational_impact" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary">
                            <option value="1" {% if evaluation.organizational_impact == 1 %}selected{% endif %}>1 - ê¸°ëŒ€ ë¯¸ë‹¬</option>
                            <option value="2" {% if evaluation.organizational_impact == 2 %}selected{% endif %}>2 - ê¸°ëŒ€ ì¶©ì¡±</option>
                            <option value="3" {% if evaluation.organizational_impact == 3 %}selected{% endif %}>3 - ê¸°ëŒ€ ì´ˆê³¼</option>
                            <option value="4" {% if evaluation.organizational_impact == 4 %}selected{% endif %}>4 - íƒì›”</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ì™¸ë¶€ ë„¤íŠ¸ì›Œí‚¹</label>
                        <select name="external_networking" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary">
                            <option value="1" {% if evaluation.external_networking == 1 %}selected{% endif %}>1 - ê¸°ëŒ€ ë¯¸ë‹¬</option>
                            <option value="2" {% if evaluation.external_networking == 2 %}selected{% endif %}>2 - ê¸°ëŒ€ ì¶©ì¡±</option>
                            <option value="3" {% if evaluation.external_networking == 3 %}selected{% endif %}>3 - ê¸°ëŒ€ ì´ˆê³¼</option>
                            <option value="4" {% if evaluation.external_networking == 4 %}selected{% endif %}>4 - íƒì›”</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- í‰ê°€ ì˜ê²¬ -->
            <div class="bg-white rounded-xl shadow-sm p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">
                    <i class="fas fa-comment-dots text-primary mr-2"></i>í‰ê°€ ì˜ê²¬
                </h2>
                <textarea name="evaluation_comment" 
                          rows="4"
                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                          placeholder="í‰ê°€ ì˜ê²¬ì„ ì…ë ¥í•˜ì„¸ìš”...">{{ evaluation.comment }}</textarea>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-between items-center bg-white rounded-xl shadow-sm p-6">
                <a href="{% url 'evaluations:impact_employees' %}" 
                   class="inline-flex items-center px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>ëª©ë¡ìœ¼ë¡œ
                </a>
                <div class="space-x-3">
                    <button type="submit" name="action" value="save" 
                            class="inline-flex items-center px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-hover transition-colors">
                        <i class="fas fa-save mr-2"></i>ì €ì¥
                    </button>
                    <button type="submit" name="action" value="submit" 
                            class="inline-flex items-center px-6 py-3 bg-status-success text-white rounded-lg hover:opacity-90 transition-opacity">
                        <i class="fas fa-check mr-2"></i>í‰ê°€ ì™„ë£Œ
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Impact option selection
    const impactOptions = document.querySelectorAll('.impact-option');
    
    impactOptions.forEach(option => {
        option.addEventListener('click', function() {
            // Remove selected class from all
            impactOptions.forEach(opt => opt.classList.remove('selected'));
            // Add selected class to clicked
            this.classList.add('selected');
            // Check the radio button
            const radio = this.querySelector('input[type="radio"]');
            if (radio) {
                radio.checked = true;
            }
        });
    });
});
</script>
{% endblock %}